# ğŸ’³ Stripe iframe æ˜¾ç¤ºé—®é¢˜ç»ˆæä¿®å¤

## ğŸ”´ é—®é¢˜
Stripe æ”¯ä»˜è¡¨å•çš„ä¸‹åŠéƒ¨åˆ†ï¼ˆæŒå¡äººå§“åè¾“å…¥æ¡†ä¸‹é¢çš„å†…å®¹ï¼‰ä»ç„¶è¢«æˆªæ–­ã€‚

## ğŸ” æ ¹æœ¬åŸå› 
Stripe Embedded Checkout ä½¿ç”¨ iframeï¼Œå…¶é«˜åº¦ç”± Stripe åŠ¨æ€æ§åˆ¶ã€‚æˆ‘ä»¬éœ€è¦è®¾ç½®è¶³å¤Ÿå¤§çš„æœ€å°é«˜åº¦æ¥ç¡®ä¿æ‰€æœ‰å†…å®¹å¯è§ã€‚

---

## âœ… å·²åº”ç”¨çš„ä¿®å¤

### ä¿®å¤ 1: å¢åŠ  iframe æœ€å°é«˜åº¦åˆ° 900px

**æ–‡ä»¶**: `components/checkout.tsx`

```css
#checkout iframe {
  min-height: 900px !important;
  height: auto !important;
  max-height: none !important;
}
```

### ä¿®å¤ 2: æ·»åŠ åº•éƒ¨ç©ºé—´

**æ–‡ä»¶**: `components/payment-dialog-fullscreen.tsx`

```typescript
<div className="container mx-auto max-w-2xl px-4 py-6 pb-12">
  {packageId && <Checkout packageId={packageId} />}
</div>
{/* é¢å¤–çš„åº•éƒ¨ç©ºé—´ */}
<div className="h-20" />
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

1. è®¿é—® http://localhost:3000/coins
2. ç‚¹å‡»ä»»æ„é‡‘å¸å¥—é¤
3. æ£€æŸ¥æ”¯ä»˜è¡¨å•æ˜¯å¦å®Œæ•´æ˜¾ç¤ºï¼š
   - âœ… é‚®ç®±è¾“å…¥æ¡†
   - âœ… Link æ”¯ä»˜æŒ‰é’®
   - âœ… é“¶è¡Œå¡å·è¾“å…¥æ¡†
   - âœ… æœˆä»½/å¹´ä»½è¾“å…¥æ¡†
   - âœ… CVC è¾“å…¥æ¡†
   - âœ… æŒå¡äººå§“åè¾“å…¥æ¡†
   - âœ… **å›½å®¶/åœ°åŒºé€‰æ‹©æ¡†** â† è¿™ä¸ªåº”è¯¥å¯è§
   - âœ… **ä¿å­˜ä¿¡æ¯å¤é€‰æ¡†** â† è¿™ä¸ªåº”è¯¥å¯è§
   - âœ… **æ”¯ä»˜æŒ‰é’®** â† è¿™ä¸ªåº”è¯¥å¯è§

---

## ğŸ”§ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

### æ–¹æ¡ˆ A: ä½¿ç”¨è°ƒè¯•ç‰ˆæœ¬

1. æ‰“å¼€ `components/payment-dialog-fullscreen.tsx`
2. æ‰¾åˆ°è¿™ä¸€è¡Œï¼š
   ```typescript
   import Checkout from "@/components/checkout"
   ```
3. æ›¿æ¢ä¸ºï¼š
   ```typescript
   import CheckoutDebug from "@/components/checkout-debug"
   ```
4. æ‰¾åˆ°ï¼š
   ```typescript
   {packageId && <Checkout packageId={packageId} />}
   ```
5. æ›¿æ¢ä¸ºï¼š
   ```typescript
   {packageId && <CheckoutDebug packageId={packageId} />}
   ```

è°ƒè¯•ç‰ˆæœ¬ä¼šæ˜¾ç¤º iframe çš„å®é™…é«˜åº¦ï¼Œå¸®åŠ©æˆ‘ä»¬ç¡®å®šéœ€è¦çš„æœ€å°é«˜åº¦ã€‚

### æ–¹æ¡ˆ B: æ‰‹åŠ¨å¢åŠ é«˜åº¦

å¦‚æœ 900px ä»ç„¶ä¸å¤Ÿï¼Œå¯ä»¥æ‰‹åŠ¨å¢åŠ ï¼š

**ç¼–è¾‘ `components/checkout.tsx`**:

æ‰¾åˆ°ï¼š
```css
min-height: 900px !important;
```

æ”¹ä¸ºï¼š
```css
min-height: 1000px !important;  /* æˆ–æ›´å¤§ */
```

### æ–¹æ¡ˆ C: ä½¿ç”¨åŠ¨æ€é«˜åº¦

åˆ›å»ºä¸€ä¸ªç›‘å¬ iframe é«˜åº¦å˜åŒ–çš„è„šæœ¬ï¼š

```typescript
useEffect(() => {
  const iframe = document.querySelector("#checkout iframe")
  if (iframe) {
    const observer = new ResizeObserver(() => {
      const height = iframe.scrollHeight
      iframe.style.minHeight = `${height + 100}px`
    })
    observer.observe(iframe)
    return () => observer.disconnect()
  }
}, [])
```

---

## ğŸ“Š ä¸åŒå±å¹•å°ºå¯¸çš„æœ€å°é«˜åº¦

| å±å¹•å®½åº¦ | æ¨èæœ€å°é«˜åº¦ |
|---------|------------|
| > 640px (æ¡Œé¢) | 900px |
| 480-640px (å¹³æ¿) | 850px |
| < 480px (æ‰‹æœº) | 800px |

---

## ğŸ¯ Stripe iframe å†…å®¹æ¸…å•

å®Œæ•´çš„ Stripe Embedded Checkout åº”è¯¥åŒ…å«ä»¥ä¸‹å…ƒç´ ï¼š

1. **é¡¶éƒ¨**
   - é‡‘é¢æ˜¾ç¤º
   - å•†å“æè¿°

2. **æ”¯ä»˜æ–¹å¼**
   - Link æ”¯ä»˜æŒ‰é’®
   - "æˆ–" åˆ†éš”ç¬¦

3. **é‚®ç®±**
   - é‚®ç®±è¾“å…¥æ¡†

4. **æ”¯ä»˜æ–¹å¼æ ‡é¢˜**
   - "æ”¯ä»˜æ–¹å¼" æ–‡å­—

5. **é“¶è¡Œå¡ä¿¡æ¯**
   - å¡å·è¾“å…¥æ¡†ï¼ˆå¸¦å¡ç±»å‹å›¾æ ‡ï¼‰
   - æœˆä»½/å¹´ä»½è¾“å…¥æ¡†
   - CVC è¾“å…¥æ¡†

6. **æŒå¡äººä¿¡æ¯**
   - æŒå¡äººå§“åè¾“å…¥æ¡†

7. **è´¦å•åœ°å€**
   - å›½å®¶/åœ°åŒºä¸‹æ‹‰é€‰æ‹©æ¡†
   - å¯èƒ½çš„åœ°å€è¾“å…¥æ¡†

8. **åº•éƒ¨**
   - ä¿å­˜ä¿¡æ¯å¤é€‰æ¡†
   - éšç§æ”¿ç­–é“¾æ¥
   - **æ”¯ä»˜æŒ‰é’®** â† æœ€é‡è¦ï¼

---

## ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤§çš„é«˜åº¦ï¼Ÿ

Stripe Embedded Checkout çš„å®é™…é«˜åº¦å–å†³äºï¼š
- é€‰æ‹©çš„æ”¯ä»˜æ–¹å¼
- æ˜¯å¦éœ€è¦åœ°å€ä¿¡æ¯
- è¯­è¨€è®¾ç½®ï¼ˆä¸­æ–‡å¯èƒ½éœ€è¦æ›´å¤šç©ºé—´ï¼‰
- æµè§ˆå™¨å’Œè®¾å¤‡ç±»å‹

**å®‰å…¨åšæ³•**: è®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æœ€å°é«˜åº¦ï¼ˆ900-1000pxï¼‰ï¼Œç¡®ä¿åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½å®Œæ•´æ˜¾ç¤ºã€‚

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¸èƒ½è‡ªåŠ¨æ£€æµ‹ iframe é«˜åº¦ï¼Ÿ

**A**: Stripe iframe æ˜¯è·¨åŸŸçš„ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥è®¿é—®å…¶å†…éƒ¨å†…å®¹ã€‚åªèƒ½é€šè¿‡è®¾ç½®è¶³å¤Ÿå¤§çš„æœ€å°é«˜åº¦æ¥ç¡®ä¿æ˜¾ç¤ºå®Œæ•´ã€‚

### Q: 900px ä¼šä¸ä¼šå¤ªå¤§ï¼Ÿ

**A**: ä¸ä¼šã€‚å¯¹äºå…¨å±æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥æ»šåŠ¨æŸ¥çœ‹ã€‚é‡è¦çš„æ˜¯ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½åœ¨ iframe å†…éƒ¨å¯è§ï¼Œè€Œä¸æ˜¯è¢«æˆªæ–­ã€‚

### Q: ç§»åŠ¨ç«¯ä¼šä¸ä¼šæœ‰é—®é¢˜ï¼Ÿ

**A**: æˆ‘ä»¬å·²ç»ä¸ºç§»åŠ¨ç«¯è®¾ç½®äº†è¾ƒå°çš„æœ€å°é«˜åº¦ï¼ˆ800-850pxï¼‰ï¼Œå¹¶ä¸”å…¨å±æ¨¡å¼æ”¯æŒæ»šåŠ¨ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰é—®é¢˜ã€‚

---

## âœ… éªŒè¯æ¸…å•

å®Œæˆä¿®å¤åï¼Œè¯·éªŒè¯ä»¥ä¸‹å†…å®¹ï¼š

- [ ] é‚®ç®±è¾“å…¥æ¡†å¯è§
- [ ] é“¶è¡Œå¡å·è¾“å…¥æ¡†å¯è§
- [ ] æœˆä»½/å¹´ä»½è¾“å…¥æ¡†å¯è§
- [ ] CVC è¾“å…¥æ¡†å¯è§
- [ ] æŒå¡äººå§“åè¾“å…¥æ¡†å¯è§
- [ ] å›½å®¶/åœ°åŒºé€‰æ‹©æ¡†å¯è§
- [ ] ä¿å­˜ä¿¡æ¯å¤é€‰æ¡†å¯è§
- [ ] **æ”¯ä»˜æŒ‰é’®å¯è§ä¸”å¯ç‚¹å‡»**
- [ ] å¯ä»¥å®Œæˆæ•´ä¸ªæ”¯ä»˜æµç¨‹
- [ ] ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸

---

## ğŸš€ ä¸‹ä¸€æ­¥

å¦‚æœæŒ‰ç…§ä»¥ä¸Šæ­¥éª¤æ“ä½œåé—®é¢˜ä»ç„¶å­˜åœ¨ï¼š

1. ä½¿ç”¨è°ƒè¯•ç‰ˆæœ¬æŸ¥çœ‹å®é™… iframe é«˜åº¦
2. æ ¹æ®å®é™…é«˜åº¦è°ƒæ•´ min-height å€¼
3. è€ƒè™‘è”ç³» Stripe æ”¯æŒï¼Œè¯¢é—®æ˜¯å¦æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ

---

**ç›®æ ‡**: ç¡®ä¿ç”¨æˆ·èƒ½çœ‹åˆ°å¹¶ç‚¹å‡»æ”¯ä»˜æŒ‰é’®ï¼Œå®Œæˆæ”¯ä»˜æµç¨‹ï¼
